import{x as o,y as r}from"./index.9dfdff68.js";import{S as s}from"./sweetalert2.all.e9d3950e.js";const g=o("category",{state:()=>({_categories:[],_category:null,addErrors:[],filter:"terbaru"}),getters:{categories:e=>{if(e.filter==="terbaru")return console.log("masuk"),e._categories;if(e.filter==="terlama")return console.log("masuk_ter"),[...e._categories].reverse()},category:e=>e._category,errors:e=>e.addErrors},actions:{getToken(){return JSON.parse(localStorage.getItem("user")).token},async getCategory(){await this.getToken();const e=await r.get("/api/category",{headers:{Authorization:"Bearer "+this.getToken()}});this._categories=e.data.data},async getCategoryById(e){await this.getToken(),await r.get(`/api/category/${e}`,{headers:{Authorization:"Bearer "+this.getToken()}}).then(t=>{this._category=t.data.data})},async handleAddData(e){this.addErrors=[],await this.getToken();try{this._categories.find(a=>a.name===e.category)?s.fire({icon:"error",title:"Error!",text:"Kategori sudah ada dalam database."}):(await r.post("/api/category",{category:e.category},{headers:{Authorization:"Bearer "+this.getToken()}}),s.fire({icon:"success",title:"Sukses!",text:"Data telah berhasil disimpan ke database."}),this.addErrors.length==0&&this.router.push({name:"data-kategori"}))}catch(t){t.response.status===422&&(this.addErrors=t.response.data.errors)}},async handleUpdateData(e,t){this.addErrors=[],await this.getToken();try{await r.put(`/api/category/${t}`,{category:e.category},{headers:{Authorization:"Bearer "+this.getToken()}}).then(this.router.push({name:"data-kategori"}))}catch(a){a.response.status===422&&(this.addErrors=a.response.data.errors)}},async handleDeleteData(e){await this.getToken(),await r.delete(`/api/category/${e}`,{headers:{Authorization:"Bearer "+this.getToken()}}).then(()=>{const t=this.categories.findIndex(a=>a.id===e);this.categories.splice(t,1)})},setFilter(e){this.filter=e}}});export{g as u};
